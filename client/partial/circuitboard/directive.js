'use strict';

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
define(['lodash',
        'angular',
        'app/module',
        'partial/treemap/layout/manager',
        'partial/treemap/layout/predefined',
        '$bind/service'], function
		(_, ng, ApiNATOMY) {
//  ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	ApiNATOMY.directive('amyCircuitboard', ['ResourceService', function (ResourceService) {
		return {

			////////////////////////////////////////////////////////////////////////////////////////////////////////////

			restrict:    'E',
			replace:     true,
			templateUrl: 'partial/circuitboard/view.html',
			scope:       {},

			////////////////////////////////////////////////////////////////////////////////////////////////////////////

			compile: function () {
				return {

					pre: function preLink($scope, iElement, iAttrs, controller) {
						$scope.depth = 0;
						$scope.maxDepth = _.parseInt(iAttrs.maxDepth);

						$scope.children = [];

						if ($scope.depth < $scope.maxDepth) {
							ResourceService.structures(_.range(60000001, 60000024+1)).then(function (structures) {
								$scope.children = structures;
							});
						}
					},

					post: function postLink($scope, iElement, iAttrs, controller) {}

				};
			}

			////////////////////////////////////////////////////////////////////////////////////////////////////////////
		};
	}]);


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
});/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
